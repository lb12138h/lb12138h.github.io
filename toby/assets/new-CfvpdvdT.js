import{m as g,n as E,r as u,j as e,B as v,a0 as k,T as S,a3 as w,a4 as L}from"./index-DERllzhn.js";import{C as o}from"./index-BwC_fqYy.js";import{F as l,I as j}from"./input-Clf9kwip.js";import{S as P}from"./selector-DpT9G-B8.js";import{S as h}from"./switch-DvbpWlb6.js";import{T as r}from"./text-area-iB4A7Wm-.js";import"./index-hSoGQ23Z.js";import"./space-bauQVJ63.js";const B=[{label:"文本",value:0},{label:"音频",value:1},{label:"图片",value:2},{label:"文件",value:3}],b={bookSourceType:0,enabled:!0,enabledExplore:!0,enabledCookieJar:!1,bookSourceGroup:"♋🈲🖇️📙,"},K=()=>{const U=g(),{id:d}=E(),[c]=l.useForm(),[I,p]=u.useState(b),[y,C]=u.useState(!1),R=async n=>{const m=Object.keys(n).reduce((a,x)=>{const i=x,s=n[i];if(s||s===!1||s===0)if(i.includes(".")){const t=i.split(".");a[t[0]]||(a[t[0]]={}),a[t[0]][t[1]]=s}else a[i]=s;return a},{});await k.rule.put(m).then(()=>{S.show({icon:"success",content:"成功!"}),c.resetFields(),U(-1)}).catch(a=>{S.show({icon:"fail",content:a.message})}),C(!1)};return u.useEffect(()=>{(async()=>{if(d){const m=await k.rule.get(w(d));if(m){const a=Object.keys(m).reduce((x,i)=>{const s=i,t=m[s];return L(t)?Object.keys(t).forEach(f=>{const T=f;x[`${s}.${f}`]=t[T]}):x[s]=t,x},{});p(a),c.resetFields(),c.setFieldsValue(a);return}}p(b),c.resetFields(),c.setFieldsValue(b)})()},[c,d]),u.useEffect(()=>{},[]),e.jsx("div",{children:I&&e.jsx(l,{name:"form",form:c,onFinish:R,initialValues:I,footer:e.jsx(v,{block:!0,type:"submit",color:"primary",loading:y,children:"提交"}),children:e.jsxs(o,{defaultActiveKey:["type","base"],children:[e.jsxs(o.Panel,{forceRender:!0,title:"类型",children:[e.jsx(l.Item,{name:"bookSourceType",label:"类型",getValueProps:n=>({value:[n]}),normalize:n=>Array.isArray(n)&&n.length===1?n[0]:void 0,rules:[{required:!0}],children:e.jsx(P,{style:{"--border-radius":"100px","--border":"solid transparent 1px","--checked-border":"solid var(--adm-color-primary) 1px","--padding":"8px 24px"},showCheckMark:!1,options:B})}),e.jsx(l.Item,{name:"enabled",label:"启用",valuePropName:"checked",rules:[{required:!0}],children:e.jsx(h,{})}),e.jsx(l.Item,{name:"enabledExplore",label:"发现",valuePropName:"checked",rules:[{required:!0}],children:e.jsx(h,{})}),e.jsx(l.Item,{name:"enabledCookieJar",label:"CookieJar",valuePropName:"checked",rules:[{required:!0}],children:e.jsx(h,{})})]},"type"),e.jsxs(o.Panel,{forceRender:!0,title:"基本",children:[e.jsx(l.Item,{name:"bookSourceUrl",label:"源 URL",rules:[{required:!0}],children:e.jsx(j,{})}),e.jsx(l.Item,{name:"bookSourceName",label:"源名称",rules:[{required:!0}],children:e.jsx(j,{})}),e.jsx(l.Item,{name:"bookSourceGroup",label:"源分组 ♋🈲🖇️📙🎶📽️🧩🈵",children:e.jsx(j,{})}),e.jsx(l.Item,{name:"bookSourceComment",label:"源注释",children:e.jsx(r,{})}),e.jsx(l.Item,{name:"loginUrl",label:"登录 URL",children:e.jsx(j,{})}),e.jsx(l.Item,{name:"loginUi",label:"登录 UI",children:e.jsx(j,{})}),e.jsx(l.Item,{name:"loginCheckJs",label:"登录检查 JS",children:e.jsx(r,{})}),e.jsx(l.Item,{name:"coverDecodeJs",label:"封面解密",children:e.jsx(r,{})}),e.jsx(l.Item,{name:"bookUrlPattern",label:"书籍 URL 正则",children:e.jsx(r,{})}),e.jsx(l.Item,{name:"header",label:"请求头",children:e.jsx(r,{})}),e.jsx(l.Item,{name:"variableComment",label:"变量说明",children:e.jsx(r,{})}),e.jsx(l.Item,{name:"concurrentRate",label:"并发率",children:e.jsx(r,{})}),e.jsx(l.Item,{name:"jsLib",label:"jsLib",children:e.jsx(r,{})})]},"base"),e.jsxs(o.Panel,{forceRender:!0,title:"搜索",children:[e.jsx(l.Item,{name:"searchUrl",label:"搜索地址",children:e.jsx(r,{})}),e.jsx(l.Item,{name:"ruleSearch.bookList",label:"书籍列表规则",children:e.jsx(r,{})}),e.jsx(l.Item,{name:"ruleSearch.checkKeyWord",label:"校验关键字",children:e.jsx(r,{})}),e.jsx(l.Item,{name:"ruleSearch.name",label:"书名规则",children:e.jsx(r,{})}),e.jsx(l.Item,{name:"ruleSearch.author",label:"作者规则",children:e.jsx(r,{})}),e.jsx(l.Item,{name:"ruleSearch.kind",label:"分类规则",children:e.jsx(r,{})}),e.jsx(l.Item,{name:"ruleSearch.wordCount",label:"字数规则",children:e.jsx(r,{})}),e.jsx(l.Item,{name:"ruleSearch.lastChapter",label:"最新章节规则",children:e.jsx(r,{})}),e.jsx(l.Item,{name:"ruleSearch.intro",label:"简介规则",children:e.jsx(r,{})}),e.jsx(l.Item,{name:"ruleSearch.coverUrl",label:"封面规则",children:e.jsx(r,{})}),e.jsx(l.Item,{name:"ruleSearch.bookUrl",label:"详情页 URL 规则",children:e.jsx(r,{})})]},"search"),e.jsxs(o.Panel,{forceRender:!0,title:"发现",children:[e.jsx(l.Item,{name:"exploreUrl",label:"发现地址规则",children:e.jsx(r,{})}),e.jsx(l.Item,{name:"ruleExplore.bookList",label:"书籍列表规则",children:e.jsx(r,{})}),e.jsx(l.Item,{name:"ruleExplore.name",label:"书名规则",children:e.jsx(r,{})}),e.jsx(l.Item,{name:"ruleExplore.author",label:"作者规则",children:e.jsx(r,{})}),e.jsx(l.Item,{name:"ruleExplore.kind",label:"分类规则",children:e.jsx(r,{})}),e.jsx(l.Item,{name:"ruleExplore.wordCount",label:"字数规则",children:e.jsx(r,{})}),e.jsx(l.Item,{name:"ruleExplore.lastChapter",label:"最新章节规则",children:e.jsx(r,{})}),e.jsx(l.Item,{name:"ruleExplore.intro",label:"简介规则",children:e.jsx(r,{})}),e.jsx(l.Item,{name:"ruleExplore.coverUrl",label:"封面规则",children:e.jsx(r,{})}),e.jsx(l.Item,{name:"ruleExplore.bookUrl",label:"详情页 URL 规则",children:e.jsx(r,{})})]},"explore"),e.jsxs(o.Panel,{forceRender:!0,title:"详情",children:[e.jsx(l.Item,{name:"ruleBookInfo.init",label:"预处理规则",children:e.jsx(r,{})}),e.jsx(l.Item,{name:"ruleBookInfo.name",label:"书名规则",children:e.jsx(r,{})}),e.jsx(l.Item,{name:"ruleBookInfo.author",label:"作者规则",children:e.jsx(r,{})}),e.jsx(l.Item,{name:"ruleBookInfo.kind",label:"分类规则",children:e.jsx(r,{})}),e.jsx(l.Item,{name:"ruleBookInfo.wordCount",label:"字数规则",children:e.jsx(r,{})}),e.jsx(l.Item,{name:"ruleBookInfo.lastChapter",label:"最新章节规则",children:e.jsx(r,{})}),e.jsx(l.Item,{name:"ruleBookInfo.intro",label:"简介规则",children:e.jsx(r,{})}),e.jsx(l.Item,{name:"ruleBookInfo.coverUrl",label:"封面规则",children:e.jsx(r,{})}),e.jsx(l.Item,{name:"ruleBookInfo.tocUrl",label:"目录 URL 规则",children:e.jsx(r,{})}),e.jsx(l.Item,{name:"ruleBookInfo.canReName",label:"允许修改书名作者",children:e.jsx(r,{placeholder:"字符串true/false"})}),e.jsx(l.Item,{name:"ruleBookInfo.downloadUrls",label:"下载URL规则",children:e.jsx(r,{})})]},"info"),e.jsxs(o.Panel,{forceRender:!0,title:"目录",children:[e.jsx(l.Item,{name:"ruleToc.preUpdateJs",label:"更新之前 JS",children:e.jsx(r,{})}),e.jsx(l.Item,{name:"ruleToc.chapterList",label:"目录列表规则",children:e.jsx(r,{})}),e.jsx(l.Item,{name:"ruleToc.chapterName",label:"章节名称规则",children:e.jsx(r,{})}),e.jsx(l.Item,{name:"ruleToc.chapterUrl",label:"章节 URL 规则",children:e.jsx(r,{})}),e.jsx(l.Item,{name:"ruleToc.formatJs",label:"格式化规则",children:e.jsx(r,{})}),e.jsx(l.Item,{name:"ruleToc.isVolume",label:"Volume标识",children:e.jsx(r,{})}),e.jsx(l.Item,{name:"ruleToc.updateTime",label:"更新时间",children:e.jsx(r,{})}),e.jsx(l.Item,{name:"ruleToc.isVip",label:"VIP 标识",children:e.jsx(r,{})}),e.jsx(l.Item,{name:"ruleToc.isPay",label:"购买标识",children:e.jsx(r,{})}),e.jsx(l.Item,{name:"ruleToc.nextTocUrl",label:"目录下一页规则",children:e.jsx(r,{})})]},"toc"),e.jsxs(o.Panel,{forceRender:!0,title:"正文",children:[e.jsx(l.Item,{name:"ruleContent.content",label:"正文规则",children:e.jsx(r,{})}),e.jsx(l.Item,{name:"ruleContent.title",label:"章节名称规则",children:e.jsx(r,{})}),e.jsx(l.Item,{name:"ruleContent.nextContentUrl",label:"目录下一页规则",children:e.jsx(r,{})}),e.jsx(l.Item,{name:"ruleContent.webJs",label:"WebView JS",children:e.jsx(r,{})}),e.jsx(l.Item,{name:"ruleContent.sourceRegex",label:"资源正则",children:e.jsx(r,{})}),e.jsx(l.Item,{name:"ruleContent.replaceRegex",label:"替换规则",children:e.jsx(r,{})}),e.jsx(l.Item,{name:"ruleContent.imageStyle",label:"图片样式",children:e.jsx(r,{})}),e.jsx(l.Item,{name:"ruleContent.imageDecode",label:"图片解密",children:e.jsx(r,{})}),e.jsx(l.Item,{name:"ruleContent.payAction",label:"购买操作",children:e.jsx(r,{})})]},"content")]})})})};export{K as default};
