"use strict";(self.webpackChunkapps_ant_admin=self.webpackChunkapps_ant_admin||[]).push([[246],{98369:function(ee,p,e){var h=e(73193),s=e.n(h),T=e(98421),m=e(44194),L=e(31549),d=function(i){var c=i.modalVisible,u=i.children;return(0,L.jsx)(T.Z,s()(s()({destroyOnClose:!0,title:"\u65B0\u5EFA",width:"80vw",open:c,footer:null},i),{},{children:u}))};p.Z=d},5420:function(ee,p,e){var h=e(90819),s=e.n(h),T=e(89933),m=e.n(T),L=e(45332),d=e.n(L),v=e(44194),i=function(u){var J=(0,v.useState)(!1),N=d()(J,2),x=N[0],C=N[1];return(0,v.useEffect)(function(){var O=function(){var Q=m()(s()().mark(function B(){return s()().wrap(function(M){for(;;)switch(M.prev=M.next){case 0:return C(!0),M.next=3,u();case 3:C(!1);case 4:case"end":return M.stop()}},B)}));return function(){return Q.apply(this,arguments)}}();O()},[]),[x]};p.Z=i},15398:function(ee,p,e){var h=e(95836),s=e(34825),T=e(44194),m=function(){var d=(0,s.yR)(function(){return h.q.tag.orderBy("order").toArray()},[]),v=(0,s.yR)(function(){return h.q.group.orderBy("order").toArray()},[]),i=(0,T.useMemo)(function(){return v==null?void 0:v.map(function(c){return{title:c.title,value:"group-"+c.id,disabled:!0,children:d==null?void 0:d.filter(function(u){return u.group===c.id}).map(function(u){return{title:u.title,value:u.id}})}}).filter(function(c){var u;return(u=c.children)===null||u===void 0?void 0:u.length})},[d,v]);return{webTagList:d,webTagGroupList:v,webTagDb:h.q,tagSelectOptions:i}};p.Z=m},86772:function(ee,p,e){e.r(p),e.d(p,{default:function(){return ne}});var h=e(45332),s=e.n(h),T=e(90819),m=e.n(T),L=e(89933),d=e.n(L),v=e(98369),i=e(73193),c=e.n(i),u=e(4977),J=e.n(u),N=e(78796),x=e.n(N),C=e(41553),O=e.n(C),Q=e(49488),B=e.n(Q),A=e(84047),M=e.n(A),ae=e(10154),w=e.n(ae),oe=e(31762),V=function(S){B()(r,S);var U=M()(r);function r(Z,q){var t;return x()(this,r),t=U.call(this,Z),w()(O()(t),"cloudName","resource-novel"),w()(O()(t),"cloudPath","resource/novel"),w()(O()(t),"web",void 0),w()(O()(t),"tableList",void 0),w()(O()(t),"storesSchema",{web:"++id, &title, &url, *tags"}),t.version(1).stores(c()(c()({},t.storesSchema),q)),t.tableList=[t.web],t}return J()(r)}(oe.N),E=new V("web-box__resource-novel");window.novelWebDb=E;var I=e(5420),z=e(15398),b=e(94665),X=e(63969),K=e(75255),R=e(70849),Y=e(37138),k=e(79044),se=e(64607),g=e(13459),W=e(64103),y=e(2037),j=e(41779),D=e(34825),_=e(44194),n=e(31549),P=function(){var S=d()(m()().mark(function U(r){var Z;return m()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return Z=k.ZP.loading("\u6B63\u5728\u6DFB\u52A0"),t.prev=1,t.next=4,E.web.put(r);case 4:return Z(),k.ZP.success("\u6DFB\u52A0\u6210\u529F"),t.abrupt("return",!0);case 9:return t.prev=9,t.t0=t.catch(1),Z(),k.ZP.error("\u6DFB\u52A0\u5931\u8D25\u8BF7\u91CD\u8BD5\uFF01"),t.abrupt("return",!1);case 14:case"end":return t.stop()}},U,null,[[1,9]])}));return function(r){return S.apply(this,arguments)}}(),re=function(){var U=(0,I.Z)(function(){return E.getCloudData()}),r=s()(U,1),Z=r[0],q=(0,D.yR)(function(){return E.web.toArray()},[]),t=(0,z.Z)(),Te=t.tagSelectOptions,xe=(0,_.useState)(!1),me=s()(xe,2),le=me[0],te=me[1],Ce=(0,_.useState)(),ve=s()(Ce,2),ue=ve[0],ce=ve[1],Oe=function(l){ce(l),te(!0)};(0,_.useEffect)(function(){le||ce(void 0)},[le]);var Me=(0,_.useState)(!1),be=s()(Me,2),fe=be[0],Ie=be[1],Re=function(l){Ie(l.target.checked)},je=(0,_.useState)(!1),he=s()(je,2),_e=he[0],Se=he[1],Le=function(l){Se(l.target.checked)},Be=(0,_.useState)(),Ee=s()(Be,2),F=Ee[0],ge=Ee[1],de=(0,_.useRef)(),ie=[{title:"id",dataIndex:"id",hideInTable:!0,hideInSearch:!0,formItemProps:{hidden:!0},fieldProps:{disabled:!0}},{title:"\u6807\u9898",dataIndex:"title",formItemProps:{rules:[{required:!0,message:"\u540D\u79F0\u4E3A\u5FC5\u586B\u9879"}]},render:function(l,a){return(0,n.jsx)("span",{className:"cursor-pointer",onClick:function(){return(0,Y.ZK)(a.url)},children:a.title})}},{title:"\u4F5C\u8005",dataIndex:"auth",hideInSearch:!0},{title:"\u526F\u6807\u9898",dataIndex:"subTitle",hideInSearch:!0},{title:"\u7F51\u5740",dataIndex:"url",formItemProps:{rules:[{required:!0,message:"\u7F51\u5740\u4E3A\u5FC5\u586B\u9879"}]},render:function(l,a){return(0,n.jsx)(se.Z.Text,{copyable:{text:a.url},children:a.url})}},{title:"tags",dataIndex:"tags",valueType:"treeSelect",fieldProps:{treeData:Te,multiple:!0,showSearch:!0,rules:[{required:!0,message:"tags\u5FC5\u586B\u9879"}]},render:function(l,a){return(0,n.jsx)(b.Z,{data:a,disabled:!fe})}},{title:"\u5907\u6CE8",dataIndex:"remark",valueType:"textarea"},{title:"\u64CD\u4F5C",dataIndex:"option",valueType:"option",fixed:_e?"right":!1,width:"160px",render:function(l,a){return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("a",{href:a.url,target:"_black",rel:"noreferrer",children:"\u8DF3\u8F6C"}),(0,n.jsx)(g.Z,{type:"vertical"}),(0,n.jsx)("a",{onClick:function(){return Oe(a)},children:"\u7F16\u8F91"}),(0,n.jsx)(g.Z,{type:"vertical"}),(0,n.jsx)("a",{onClick:function(){return ge(a)},children:"\u8BE6\u60C5"})]})}}],Ae=(0,_.useState)({}),pe=s()(Ae,2),H=pe[0],De=pe[1],We=(0,_.useState)([]),Pe=s()(We,2),ye=Pe[0],we=Pe[1];return(0,_.useEffect)(function(){var o=q||[],l=Object.keys(H);l.length&&l.forEach(function(a){switch(a){case"title":o=o.filter(function(f){var G;return f.title.includes(H[a]||"")||((G=f.subTitle)===null||G===void 0?void 0:G.includes(H[a]||""))});break;case"url":o=o.filter(function(f){return f.url.includes(H[a]||"")});break;case"tags":o=o.filter(function(f){var G=H[a];return G?G.every(function($){return f.tags.includes($)}):!0});break;default:break}}),we(o)},[q,H]),(0,n.jsxs)(X._z,{children:[(0,n.jsx)(K.Z,{headerTitle:"\u67E5\u8BE2\u8868\u683C",actionRef:de,rowKey:"id",search:{labelWidth:80},scroll:{x:"max-content"},toolBarRender:function(){return[(0,n.jsx)(W.ZP,{type:"primary",onClick:function(){return te(!0)},loading:Z,children:"\u65B0\u5EFA"},"1"),(0,n.jsx)(y.Z,{checked:fe,onChange:Re,children:"tag"}),(0,n.jsx)(y.Z,{checked:_e,onChange:Le,children:"\u64CD\u4F5C"})]},options:{fullScreen:!0,reload:!1},dataSource:ye,columns:ie,onSubmit:De,onReset:function(){return De({})}},"".concat(_e)),(0,n.jsx)(v.Z,{title:ue&&"\u7F16\u8F91 - ".concat(ue.id),onCancel:function(){return te(!1)},modalVisible:le,children:(0,n.jsx)(K.Z,{onSubmit:function(){var o=d()(m()().mark(function l(a){var f;return m()().wrap(function($){for(;;)switch($.prev=$.next){case 0:return $.next=2,P(a);case 2:f=$.sent,f&&(te(!1),de.current&&de.current.reload());case 4:case"end":return $.stop()}},l)}));return function(l){return o.apply(this,arguments)}}(),rowKey:"id",type:"form",columns:ie,form:{initialValues:ue}})}),(0,n.jsx)(j.Z,{width:600,open:!!F,onClose:function(){ge(void 0)},closable:!0,children:F&&(0,n.jsx)(R.vY,{column:2,title:F.title,request:d()(m()().mark(function o(){return m()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",{data:F||{}});case 1:case"end":return a.stop()}},o)})),params:{id:F==null?void 0:F.id},columns:ie})})]})},ne=re},94665:function(ee,p,e){var h=e(90819),s=e.n(h),T=e(89933),m=e.n(T),L=e(45332),d=e.n(L),v=e(73193),i=e.n(v),c=e(85045),u=e.n(c),J=e(16493),N=e(95836),x=e(92259),C=e(88251),O=e(8504),Q=e(13221),B=e(44194),A=e(31549),M={cursor:"move",transition:"unset"},ae=function(V){var E=V.tag,I=(0,C.nB)({id:E.id}),z=I.listeners,b=I.transform,X=I.transition,K=I.isDragging,R=I.setNodeRef,Y=b?i()(i()({},M),{},{transform:"translate3d(".concat(b.x,"px, ").concat(b.y,"px, 0)"),transition:K?"unset":X}):M;return(0,A.jsx)(O.Z,i()(i()({style:Y,ref:R},z),{},{children:E.text}))},w=function(V){var E=V.data,I=V.disabled,z=E.tags,b=z===void 0?[]:z,X=(0,B.useState)([{id:1,text:"Tag 1"},{id:2,text:"Tag 2"},{id:3,text:"Tag 3"}]),K=d()(X,2),R=K[0],Y=K[1];(0,B.useEffect)(function(){var g=function(){var W=m()(s()().mark(function y(){var j,D,_,n,P,re,ne,S;return s()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:j=[],D=!1,_=!1,r.prev=3,P=u()(b);case 5:return r.next=7,P.next();case 7:if(!(D=!(re=r.sent).done)){r.next=16;break}return ne=re.value,r.next=11,N.q.tag.get(ne);case 11:S=r.sent,S&&j.push({id:S.id,text:S.title});case 13:D=!1,r.next=5;break;case 16:r.next=22;break;case 18:r.prev=18,r.t0=r.catch(3),_=!0,n=r.t0;case 22:if(r.prev=22,r.prev=23,!(D&&P.return!=null)){r.next=27;break}return r.next=27,P.return();case 27:if(r.prev=27,!_){r.next=30;break}throw n;case 30:return r.finish(27);case 31:return r.finish(22);case 32:Y(j);case 33:case"end":return r.stop()}},y,null,[[3,18,22,32],[23,,27,31]])}));return function(){return W.apply(this,arguments)}}();g()},[b]);var k=(0,x.Dy)((0,x.VT)(x.we)),se=function(W){var y=W.active,j=W.over;j&&y.id!==j.id&&Y(function(D){var _=D.findIndex(function(P){return P.id===y.id}),n=D.findIndex(function(P){return P.id===j.id});return(0,C.Rp)(D,_,n)})};return(0,B.useEffect)(function(){if((b==null?void 0:b.length)===R.length){var g=R.map(function(W){return W.id});g.join()!==b.join()&&J.O.web.update(E.id,{tags:g})}},[R,b,E]),(0,A.jsx)(x.LB,{sensors:k,onDragEnd:se,collisionDetection:x.pE,children:(0,A.jsx)(C.Fo,{disabled:I,items:R,strategy:C.PG,children:(0,A.jsx)(Q.Z,{gap:"4px 0",wrap:!0,children:R.map(function(g){return(0,A.jsx)(ae,{tag:g},g.id)})})})})};p.Z=w}}]);
