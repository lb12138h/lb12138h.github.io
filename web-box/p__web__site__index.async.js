"use strict";(self.webpackChunkapps_ant_admin=self.webpackChunkapps_ant_admin||[]).push([[462],{24936:function(se,G,e){var K=e(73193),x=e.n(K),H=e(97190),h=e(44194),z=e(31549),R=function(M){var N=M.modalVisible,Y=M.children;return(0,z.jsx)(H.Z,x()(x()({destroyOnClose:!0,title:"\u65B0\u5EFA",width:"80vw",open:N,footer:null},M),{},{children:Y}))};G.Z=R},61158:function(se,G,e){e.r(G),e.d(G,{default:function(){return We}});var K=e(45332),x=e.n(K),H=e(90819),h=e.n(H),z=e(89933),R=e.n(z),X=e(24936),M=e(4977),N=e.n(M),Y=e(78796),ue=e.n(Y),ie=e(41553),le=e.n(ie),oe=e(49488),de=e.n(oe),fe=e(84047),ce=e.n(fe),ve=e(10154),he=e.n(ve),me=e(99338),pe=function(b){de()(t,b);var i=ce()(t);function t(){var r;return ue()(this,t),r=i.call(this,"HashDB"),he()(le()(r),"hash",void 0),r.version(1).stores({hash:"&hash"}),r}return N()(t)}(me.ZP),L=new pe,ge=function(){var b=R()(h()().mark(function i(){return h()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:case"end":return r.stop()}},i)}));return function(){return b.apply(this,arguments)}}();L.on("populate",ge),window.hashDb=L;var k=e(51264),be=function(){var b=R()(h()().mark(function i(t){var r,o,n,c,d=arguments;return h()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return r=d.length>1&&d[1]!==void 0?d[1]:"img",a.next=3,L.hash.get(t);case 3:if(o=a.sent,o!=null&&o.base64){a.next=14;break}return a.next=7,(0,k.I)({path:"hash/".concat(r,"/").concat(t),autoCreate:!1});case 7:if(n=a.sent,!n.success){a.next=13;break}return c=n.data.content,a.next=12,L.hash.put({hash:t,base64:c});case 12:return a.abrupt("return",{status:200,success:!0,data:c});case 13:return a.abrupt("return",n);case 14:return a.abrupt("return",{status:200,success:!0,data:o.base64});case 15:case"end":return a.stop()}},i)}));return function(t){return b.apply(this,arguments)}}(),ye=function(){var b=R()(h()().mark(function i(t){var r,o,n,c,d;return h()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return r=t.hash,o=t.content,n=t.type,c=n===void 0?"img":n,a.next=3,L.hash.get(r);case 3:if(d=a.sent,d!=null&&d.hash){a.next=10;break}return a.next=7,L.hash.put({hash:r,base64:o});case 7:return a.next=9,(0,k.I)({path:"hash/".concat(c,"/").concat(r),content:o,autoCreate:!0});case 9:return a.abrupt("return",a.sent);case 10:return a.abrupt("return",{status:200,success:!0,data:d.base64});case 11:case"end":return a.stop()}},i)}));return function(t){return b.apply(this,arguments)}}(),Se=e(94e3),Te=e(87660),je=e(67247),U=e(25248),q=e(16478),Ie=e(34934),g=e(44194),u=e(31549),Ce=function(i){return new Promise(function(t,r){var o=new FileReader;o.readAsDataURL(i),o.onload=function(){return t(o.result)},o.onerror=function(n){return r(n)}})},Pe=function(i){var t=["image/jpeg","image/png","image/svg+xml"].includes(i.type);t||U.ZP.error("You can only upload JPG/PNG/SVG file!");var r=i.size/1024/1024<2;return r||U.ZP.error("Image must smaller than 2MB!"),!1},Ee=function(i){var t=i.value,r=i.onChange,o=i.onlyPreview,n=(0,g.useState)(!1),c=x()(n,2),d=c[0],C=c[1],a=(0,g.useState)(),j=x()(a,2),y=j[0],B=j[1],F=function(){var E=R()(h()().mark(function p(m){var S,Z;return h()().wrap(function(I){for(;;)switch(I.prev=I.next){case 0:if(!d){I.next=2;break}return I.abrupt("return");case 2:return C(!0),console.log("info",m),I.next=6,Ce(m.file.originFileObj||m.file);case 6:return S=I.sent,B(S),I.next=10,(0,je.x5)(S);case 10:return Z=I.sent,I.next=13,ye({hash:Z,content:S});case 13:r==null||r(Z),C(!1);case 15:case"end":return I.stop()}},p)}));return function(m){return E.apply(this,arguments)}}(),P=(0,u.jsxs)("button",{style:{border:0,background:"none"},type:"button",children:[d?(0,u.jsx)(Se.Z,{}):(0,u.jsx)(Te.Z,{}),(0,u.jsx)("div",{style:{marginTop:8},children:"Upload"})]});return(0,g.useEffect)(function(){var E=function(){var p=R()(h()().mark(function m(){var S;return h()().wrap(function(T){for(;;)switch(T.prev=T.next){case 0:if(t){T.next=2;break}return T.abrupt("return");case 2:return T.next=4,be(t);case 4:S=T.sent,S.success&&B(S.data);case 6:case"end":return T.stop()}},m)}));return function(){return p.apply(this,arguments)}}();E()},[t]),o?(0,u.jsx)(q.Z,{src:y,width:32}):(0,u.jsx)(Ie.Z,{name:"avatar",listType:"picture-card",className:"avatar-uploader",showUploadList:!1,openFileDialogOnClick:!y,beforeUpload:Pe,onChange:F,children:y?(0,u.jsx)(q.Z,{src:y}):P})},_=Ee,$=e(36704),J=e(47934),De=e(79412),ee=e(96682),xe=e(65590),re=e(88539),Re=e(99255),Be=e(30280),Q=e(34825),Fe=e(73193),W=e.n(Fe),Ze=e(85045),we=e.n(Ze),A=e(92259),V=e(88251),Oe=e(9425),Le=e(10034),te={cursor:"move",transition:"unset"},Me=function(i){var t=i.tag,r=(0,V.nB)({id:t.id}),o=r.listeners,n=r.transform,c=r.transition,d=r.isDragging,C=r.setNodeRef,a=n?W()(W()({},te),{},{transform:"translate3d(".concat(n.x,"px, ").concat(n.y,"px, 0)"),transition:d?"unset":c}):te;return(0,u.jsx)(Oe.Z,W()(W()({style:a,ref:C},o),{},{children:t.text}))},Ue=function(i){var t=i.data,r=t.tags,o=(0,g.useState)([{id:1,text:"Tag 1"},{id:2,text:"Tag 2"},{id:3,text:"Tag 3"}]),n=x()(o,2),c=n[0],d=n[1];(0,g.useEffect)(function(){var j=function(){var y=R()(h()().mark(function B(){var F,P,E,p,m,S,Z,T;return h()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:F=[],P=!1,E=!1,s.prev=3,m=we()(r);case 5:return s.next=7,m.next();case 7:if(!(P=!(S=s.sent).done)){s.next=16;break}return Z=S.value,s.next=11,J.q.tag.get(Z);case 11:T=s.sent,T&&F.push({id:T.id,text:T.title});case 13:P=!1,s.next=5;break;case 16:s.next=22;break;case 18:s.prev=18,s.t0=s.catch(3),E=!0,p=s.t0;case 22:if(s.prev=22,s.prev=23,!(P&&m.return!=null)){s.next=27;break}return s.next=27,m.return();case 27:if(s.prev=27,!E){s.next=30;break}throw p;case 30:return s.finish(27);case 31:return s.finish(22);case 32:d(F);case 33:case"end":return s.stop()}},B,null,[[3,18,22,32],[23,,27,31]])}));return function(){return y.apply(this,arguments)}}();j()},[r]);var C=(0,A.Dy)((0,A.VT)(A.we)),a=function(y){var B=y.active,F=y.over;F&&B.id!==F.id&&d(function(P){var E=P.findIndex(function(m){return m.id===B.id}),p=P.findIndex(function(m){return m.id===F.id});return(0,V.Rp)(P,E,p)})};return(0,g.useEffect)(function(){if(r.length===c.length){var j=c.map(function(y){return y.id});j.join()!==r.join()&&$.O.web.update(t.id,{tags:j})}},[c,r,t]),(0,u.jsx)(A.LB,{sensors:C,onDragEnd:a,collisionDetection:A.pE,children:(0,u.jsx)(V.Fo,{items:c,strategy:V.PG,children:(0,u.jsx)(Le.Z,{gap:"4px 0",wrap:!0,children:c.map(function(j){return(0,u.jsx)(Me,{tag:j},j.id)})})})})},Ae=Ue,Ge=function(){var b=R()(h()().mark(function i(t){var r;return h()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return r=U.ZP.loading("\u6B63\u5728\u6DFB\u52A0"),n.prev=1,n.next=4,$.O.web.put(t);case 4:return r(),U.ZP.success("\u6DFB\u52A0\u6210\u529F"),n.abrupt("return",!0);case 9:return n.prev=9,n.t0=n.catch(1),r(),U.ZP.error("\u6DFB\u52A0\u5931\u8D25\u8BF7\u91CD\u8BD5\uFF01"),n.abrupt("return",!1);case 14:case"end":return n.stop()}},i,null,[[1,9]])}));return function(t){return b.apply(this,arguments)}}(),$e=function(){var i=(0,Q.yR)(function(){return $.O.web.toArray()},[]),t=(0,Q.yR)(function(){return J.q.tag.orderBy("order").toArray()},[]),r=(0,Q.yR)(function(){return J.q.group.orderBy("order").toArray()},[]),o=(0,g.useMemo)(function(){return r==null?void 0:r.map(function(l){return{title:l.title,value:"group-"+l.id,disabled:!0,children:t==null?void 0:t.filter(function(f){return f.group===l.id}).map(function(f){return{title:f.title,value:f.id}})}}).filter(function(l){var f;return(f=l.children)===null||f===void 0?void 0:f.length})},[t,r]),n=(0,g.useState)(!1),c=x()(n,2),d=c[0],C=c[1],a=(0,g.useState)(),j=x()(a,2),y=j[0],B=j[1],F=function(f){B(f),C(!0)};(0,g.useEffect)(function(){d||B(void 0)},[d]);var P=(0,g.useState)(),E=x()(P,2),p=E[0],m=E[1],S=(0,g.useRef)(),Z=[{title:"id",dataIndex:"id",hideInTable:!0,hideInSearch:!0,formItemProps:{hidden:!0},fieldProps:{disabled:!0}},{title:"\u56FE\u6807",dataIndex:"icon",hideInSearch:!0,renderFormItem:function(){return(0,u.jsx)(_,{})},render:function(f,v,D,w,O){return(0,u.jsx)(_,{value:v.icon,onlyPreview:!0})}},{title:"\u6807\u9898",dataIndex:"title",formItemProps:{rules:[{required:!0,message:"\u540D\u79F0\u4E3A\u5FC5\u586B\u9879"}]}},{title:"\u526F\u6807\u9898",dataIndex:"subTitle",hideInSearch:!0},{title:"\u7F51\u5740",dataIndex:"url",formItemProps:{rules:[{required:!0,message:"\u7F51\u5740\u4E3A\u5FC5\u586B\u9879"}]}},{title:"tags",dataIndex:"tags",valueType:"treeSelect",fieldProps:{treeData:o,multiple:!0,showSearch:!0,rules:[{required:!0,message:"tags\u5FC5\u586B\u9879"}]},render:function(f,v){return(0,u.jsx)(Ae,{data:v})}},{title:"\u5907\u6CE8",dataIndex:"remark",valueType:"textarea"},{title:"\u64CD\u4F5C",dataIndex:"option",valueType:"option",fixed:"right",width:"160px",render:function(f,v){return(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)("a",{href:v.url,target:"_black",rel:"noreferrer",children:"\u8DF3\u8F6C"}),(0,u.jsx)(re.Z,{type:"vertical"}),(0,u.jsx)("a",{onClick:function(){return F(v)},children:"\u7F16\u8F91"}),(0,u.jsx)(re.Z,{type:"vertical"}),(0,u.jsx)("a",{onClick:function(){return m(v)},children:"\u8BE6\u60C5"})]})}}];(0,g.useEffect)(function(){$.O.getCloudData()},[]);var T=(0,g.useState)({}),I=x()(T,2),s=I[0],ae=I[1],Ve=(0,g.useState)([]),ne=x()(Ve,2),Ke=ne[0],He=ne[1];return(0,g.useEffect)(function(){var l=i||[],f=Object.keys(s);f.length&&f.forEach(function(v){switch(v){case"title":l=l.filter(function(D){var w;return D.title.includes(s[v]||"")||((w=D.subTitle)===null||w===void 0?void 0:w.includes(s[v]||""))});break;case"url":l=l.filter(function(D){return D.url.includes(s[v]||"")});break;case"tags":l=l.filter(function(D){var w=s[v];return w?w.every(function(O){return D.tags.includes(O)}):!0});break;default:break}}),He(l)},[i,s]),(0,u.jsxs)(De._z,{children:[(0,u.jsx)(ee.Z,{headerTitle:"\u67E5\u8BE2\u8868\u683C",actionRef:S,rowKey:"id",search:{labelWidth:80},scroll:{x:"max-content"},toolBarRender:function(){return[(0,u.jsx)(Re.ZP,{type:"primary",onClick:function(){return C(!0)},children:"\u65B0\u5EFA"},"1")]},dataSource:Ke,columns:Z,onSubmit:ae,onReset:function(){return ae({})}}),(0,u.jsx)(X.Z,{title:y&&"\u7F16\u8F91 - ".concat(y.id),onCancel:function(){return C(!1)},modalVisible:d,children:(0,u.jsx)(ee.Z,{onSubmit:function(){var l=R()(h()().mark(function f(v){var D;return h()().wrap(function(O){for(;;)switch(O.prev=O.next){case 0:return O.next=2,Ge(v);case 2:D=O.sent,D&&(C(!1),S.current&&S.current.reload());case 4:case"end":return O.stop()}},f)}));return function(f){return l.apply(this,arguments)}}(),rowKey:"id",type:"form",columns:Z,form:{initialValues:y}})}),(0,u.jsx)(Be.Z,{width:600,open:!!p,onClose:function(){m(void 0)},closable:!0,children:p&&(0,u.jsx)(xe.vY,{column:2,title:p.title,request:R()(h()().mark(function l(){return h()().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:return v.abrupt("return",{data:p||{}});case 1:case"end":return v.stop()}},l)})),params:{id:p==null?void 0:p.id},columns:Z})})]})},We=$e}}]);
