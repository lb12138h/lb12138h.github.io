"use strict";(self.webpackChunkapps_ant_admin=self.webpackChunkapps_ant_admin||[]).push([[918],{98369:function(ee,p,e){var h=e(73193),s=e.n(h),T=e(98421),m=e(44194),S=e(31549),i=function(d){var b=d.modalVisible,l=d.children;return(0,S.jsx)(T.Z,s()(s()({destroyOnClose:!0,title:"\u65B0\u5EFA",width:"80vw",open:b,footer:null},d),{},{children:l}))};p.Z=i},5420:function(ee,p,e){var h=e(90819),s=e.n(h),T=e(89933),m=e.n(T),S=e(45332),i=e.n(S),c=e(44194),d=function(l){var J=(0,c.useState)(!1),V=i()(J,2),C=V[0],O=V[1];return(0,c.useEffect)(function(){var x=function(){var Q=m()(s()().mark(function B(){return s()().wrap(function(M){for(;;)switch(M.prev=M.next){case 0:return O(!0),M.next=3,l();case 3:O(!1);case 4:case"end":return M.stop()}},B)}));return function(){return Q.apply(this,arguments)}}();x()},[]),[C]};p.Z=d},15398:function(ee,p,e){var h=e(95836),s=e(34825),T=e(44194),m=function(){var i=(0,s.yR)(function(){return h.q.tag.orderBy("order").toArray()},[]),c=(0,s.yR)(function(){return h.q.group.orderBy("order").toArray()},[]),d=(0,T.useMemo)(function(){return c==null?void 0:c.map(function(b){return{title:b.title,value:"group-"+b.id,disabled:!0,children:i==null?void 0:i.filter(function(l){return l.group===b.id}).map(function(l){return{title:l.title,value:l.id}})}}).filter(function(b){var l;return(l=b.children)===null||l===void 0?void 0:l.length})},[i,c]);return{webTagList:i,webTagGroupList:c,webTagDb:h.q,tagSelectOptions:d}};p.Z=m},76140:function(ee,p,e){e.r(p),e.d(p,{default:function(){return ne}});var h=e(45332),s=e.n(h),T=e(90819),m=e.n(T),S=e(89933),i=e.n(S),c=e(98369),d=e(73193),b=e.n(d),l=e(4977),J=e.n(l),V=e(78796),C=e.n(V),O=e(41553),x=e.n(O),Q=e(49488),B=e.n(Q),A=e(84047),M=e.n(A),ae=e(10154),w=e.n(ae),oe=e(31762),N=function(L){B()(r,L);var U=M()(r);function r(Z,q){var t;return C()(this,r),t=U.call(this,Z),w()(x()(t),"cloudName","resource-photo"),w()(x()(t),"cloudPath","resource/photo"),w()(x()(t),"web",void 0),w()(x()(t),"tableList",void 0),w()(x()(t),"storesSchema",{web:"++id, &title, &url, *tags"}),t.version(1).stores(b()(b()({},t.storesSchema),q)),t.tableList=[t.web],t}return J()(r)}(oe.N),E=new N("web-box__resource-photo");window.photoWebDb=E;var R=e(5420),z=e(15398),v=e(94665),X=e(63969),K=e(75255),I=e(70849),Y=e(37138),k=e(79044),se=e(64607),g=e(13459),W=e(64103),y=e(2037),j=e(41779),D=e(34825),_=e(44194),n=e(31549),P=function(){var L=i()(m()().mark(function U(r){var Z;return m()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return Z=k.ZP.loading("\u6B63\u5728\u6DFB\u52A0"),t.prev=1,t.next=4,E.web.put(r);case 4:return Z(),k.ZP.success("\u6DFB\u52A0\u6210\u529F"),t.abrupt("return",!0);case 9:return t.prev=9,t.t0=t.catch(1),Z(),k.ZP.error("\u6DFB\u52A0\u5931\u8D25\u8BF7\u91CD\u8BD5\uFF01"),t.abrupt("return",!1);case 14:case"end":return t.stop()}},U,null,[[1,9]])}));return function(r){return L.apply(this,arguments)}}(),re=function(){var U=(0,R.Z)(function(){return E.getCloudData()}),r=s()(U,1),Z=r[0],q=(0,D.yR)(function(){return E.web.toArray()},[]),t=(0,z.Z)(),Te=t.tagSelectOptions,Ce=(0,_.useState)(!1),me=s()(Ce,2),ue=me[0],te=me[1],Oe=(0,_.useState)(),ce=s()(Oe,2),le=ce[0],be=ce[1],xe=function(u){be(u),te(!0)};(0,_.useEffect)(function(){ue||be(void 0)},[ue]);var Me=(0,_.useState)(!1),ve=s()(Me,2),fe=ve[0],Re=ve[1],Ie=function(u){Re(u.target.checked)},je=(0,_.useState)(!1),he=s()(je,2),_e=he[0],Le=he[1],Se=function(u){Le(u.target.checked)},Be=(0,_.useState)(),Ee=s()(Be,2),F=Ee[0],ge=Ee[1],ie=(0,_.useRef)(),de=[{title:"id",dataIndex:"id",hideInTable:!0,hideInSearch:!0,formItemProps:{hidden:!0},fieldProps:{disabled:!0}},{title:"\u6807\u9898",dataIndex:"title",formItemProps:{rules:[{required:!0,message:"\u540D\u79F0\u4E3A\u5FC5\u586B\u9879"}]},render:function(u,a){return(0,n.jsx)("span",{className:"cursor-pointer",onClick:function(){return(0,Y.ZK)(a.url)},children:a.title})}},{title:"\u526F\u6807\u9898",dataIndex:"subTitle",hideInSearch:!0},{title:"\u7F51\u5740",dataIndex:"url",formItemProps:{rules:[{required:!0,message:"\u7F51\u5740\u4E3A\u5FC5\u586B\u9879"}]},render:function(u,a){return(0,n.jsx)(se.Z.Text,{copyable:{text:a.url},children:a.url})}},{title:"tags",dataIndex:"tags",valueType:"treeSelect",fieldProps:{treeData:Te,multiple:!0,showSearch:!0,rules:[{required:!0,message:"tags\u5FC5\u586B\u9879"}]},render:function(u,a){return(0,n.jsx)(v.Z,{data:a,disabled:!fe})}},{title:"\u5907\u6CE8",dataIndex:"remark",valueType:"textarea"},{title:"\u64CD\u4F5C",dataIndex:"option",valueType:"option",fixed:_e?"right":!1,width:"160px",render:function(u,a){return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("a",{href:a.url,target:"_black",rel:"noreferrer",children:"\u8DF3\u8F6C"}),(0,n.jsx)(g.Z,{type:"vertical"}),(0,n.jsx)("a",{onClick:function(){return xe(a)},children:"\u7F16\u8F91"}),(0,n.jsx)(g.Z,{type:"vertical"}),(0,n.jsx)("a",{onClick:function(){return ge(a)},children:"\u8BE6\u60C5"})]})}}],Ae=(0,_.useState)({}),pe=s()(Ae,2),H=pe[0],De=pe[1],We=(0,_.useState)([]),Pe=s()(We,2),ye=Pe[0],we=Pe[1];return(0,_.useEffect)(function(){var o=q||[],u=Object.keys(H);u.length&&u.forEach(function(a){switch(a){case"title":o=o.filter(function(f){var G;return f.title.includes(H[a]||"")||((G=f.subTitle)===null||G===void 0?void 0:G.includes(H[a]||""))});break;case"url":o=o.filter(function(f){return f.url.includes(H[a]||"")});break;case"tags":o=o.filter(function(f){var G=H[a];return G?G.every(function($){return f.tags.includes($)}):!0});break;default:break}}),we(o)},[q,H]),(0,n.jsxs)(X._z,{children:[(0,n.jsx)(K.Z,{headerTitle:"\u67E5\u8BE2\u8868\u683C",actionRef:ie,rowKey:"id",search:{labelWidth:80},scroll:{x:"max-content"},toolBarRender:function(){return[(0,n.jsx)(W.ZP,{type:"primary",onClick:function(){return te(!0)},loading:Z,children:"\u65B0\u5EFA"},"1"),(0,n.jsx)(y.Z,{checked:fe,onChange:Ie,children:"tag"}),(0,n.jsx)(y.Z,{checked:_e,onChange:Se,children:"\u64CD\u4F5C"})]},options:{fullScreen:!0,reload:!1},dataSource:ye,columns:de,onSubmit:De,onReset:function(){return De({})}},"".concat(_e)),(0,n.jsx)(c.Z,{title:le&&"\u7F16\u8F91 - ".concat(le.id),onCancel:function(){return te(!1)},modalVisible:ue,children:(0,n.jsx)(K.Z,{onSubmit:function(){var o=i()(m()().mark(function u(a){var f;return m()().wrap(function($){for(;;)switch($.prev=$.next){case 0:return $.next=2,P(a);case 2:f=$.sent,f&&(te(!1),ie.current&&ie.current.reload());case 4:case"end":return $.stop()}},u)}));return function(u){return o.apply(this,arguments)}}(),rowKey:"id",type:"form",columns:de,form:{initialValues:le}})}),(0,n.jsx)(j.Z,{width:600,open:!!F,onClose:function(){ge(void 0)},closable:!0,children:F&&(0,n.jsx)(I.vY,{column:2,title:F.title,request:i()(m()().mark(function o(){return m()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",{data:F||{}});case 1:case"end":return a.stop()}},o)})),params:{id:F==null?void 0:F.id},columns:de})})]})},ne=re},94665:function(ee,p,e){var h=e(90819),s=e.n(h),T=e(89933),m=e.n(T),S=e(45332),i=e.n(S),c=e(73193),d=e.n(c),b=e(85045),l=e.n(b),J=e(16493),V=e(95836),C=e(92259),O=e(88251),x=e(8504),Q=e(13221),B=e(44194),A=e(31549),M={cursor:"move",transition:"unset"},ae=function(N){var E=N.tag,R=(0,O.nB)({id:E.id}),z=R.listeners,v=R.transform,X=R.transition,K=R.isDragging,I=R.setNodeRef,Y=v?d()(d()({},M),{},{transform:"translate3d(".concat(v.x,"px, ").concat(v.y,"px, 0)"),transition:K?"unset":X}):M;return(0,A.jsx)(x.Z,d()(d()({style:Y,ref:I},z),{},{children:E.text}))},w=function(N){var E=N.data,R=N.disabled,z=E.tags,v=z===void 0?[]:z,X=(0,B.useState)([{id:1,text:"Tag 1"},{id:2,text:"Tag 2"},{id:3,text:"Tag 3"}]),K=i()(X,2),I=K[0],Y=K[1];(0,B.useEffect)(function(){var g=function(){var W=m()(s()().mark(function y(){var j,D,_,n,P,re,ne,L;return s()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:j=[],D=!1,_=!1,r.prev=3,P=l()(v);case 5:return r.next=7,P.next();case 7:if(!(D=!(re=r.sent).done)){r.next=16;break}return ne=re.value,r.next=11,V.q.tag.get(ne);case 11:L=r.sent,L&&j.push({id:L.id,text:L.title});case 13:D=!1,r.next=5;break;case 16:r.next=22;break;case 18:r.prev=18,r.t0=r.catch(3),_=!0,n=r.t0;case 22:if(r.prev=22,r.prev=23,!(D&&P.return!=null)){r.next=27;break}return r.next=27,P.return();case 27:if(r.prev=27,!_){r.next=30;break}throw n;case 30:return r.finish(27);case 31:return r.finish(22);case 32:Y(j);case 33:case"end":return r.stop()}},y,null,[[3,18,22,32],[23,,27,31]])}));return function(){return W.apply(this,arguments)}}();g()},[v]);var k=(0,C.Dy)((0,C.VT)(C.we)),se=function(W){var y=W.active,j=W.over;j&&y.id!==j.id&&Y(function(D){var _=D.findIndex(function(P){return P.id===y.id}),n=D.findIndex(function(P){return P.id===j.id});return(0,O.Rp)(D,_,n)})};return(0,B.useEffect)(function(){if((v==null?void 0:v.length)===I.length){var g=I.map(function(W){return W.id});g.join()!==v.join()&&J.O.web.update(E.id,{tags:g})}},[I,v,E]),(0,A.jsx)(C.LB,{sensors:k,onDragEnd:se,collisionDetection:C.pE,children:(0,A.jsx)(O.Fo,{disabled:R,items:I,strategy:O.PG,children:(0,A.jsx)(Q.Z,{gap:"4px 0",wrap:!0,children:I.map(function(g){return(0,A.jsx)(ae,{tag:g},g.id)})})})})};p.Z=w}}]);
